{
  "openapi": "3.0.0",
  "components": {
    "schemas": {
      "CreateAppointmentRequest": {
        "type": "object",
        "required": [
          "insuredId",
          "scheduleId",
          "countryISO"
        ],
        "properties": {
          "insuredId": {
            "type": "string",
            "pattern": "^\\d{5}$",
            "description": "5-digit insured identification code",
            "example": "12345"
          },
          "scheduleId": {
            "type": "integer",
            "minimum": 1,
            "description": "Unique identifier for the appointment slot",
            "example": 100
          },
          "countryISO": {
            "type": "string",
            "enum": [
              "PE",
              "CL"
            ],
            "description": "Country code (PE for Peru, CL for Chile)",
            "example": "PE"
          }
        }
      },
      "CreateAppointmentResponse": {
        "type": "object",
        "properties": {
          "appointmentId": {
            "type": "string",
            "description": "Unique appointment identifier (ULID format)",
            "example": "01ARZ3NDEKTSV4RRFFQ69G5FAV"
          },
          "status": {
            "type": "string",
            "enum": [
              "pending"
            ],
            "description": "Current status of the appointment",
            "example": "pending"
          },
          "message": {
            "type": "string",
            "description": "Confirmation message",
            "example": "Appointment created successfully and is being processed"
          }
        }
      },
      "AppointmentListResponse": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "appointmentId": {
              "type": "string",
              "description": "Unique appointment identifier",
              "example": "01ARZ3NDEKTSV4RRFFQ69G5FAV"
            },
            "insuredId": {
              "type": "string",
              "description": "5-digit insured identification code",
              "example": "12345"
            },
            "scheduleId": {
              "type": "integer",
              "description": "Appointment slot identifier",
              "example": 100
            },
            "countryISO": {
              "type": "string",
              "enum": [
                "PE",
                "CL"
              ],
              "description": "Country code",
              "example": "PE"
            },
            "status": {
              "type": "string",
              "enum": [
                "pending",
                "completed",
                "failed"
              ],
              "description": "Current appointment status",
              "example": "completed"
            },
            "createdAt": {
              "type": "string",
              "format": "date-time",
              "description": "Appointment creation timestamp",
              "example": "2024-09-11T10:30:00.000Z"
            },
            "updatedAt": {
              "type": "string",
              "format": "date-time",
              "description": "Last update timestamp",
              "example": "2024-09-11T10:32:15.000Z"
            }
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error type",
            "example": "ValidationError"
          },
          "message": {
            "type": "string",
            "description": "Human-readable error message",
            "example": "Invalid input data"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Error occurrence timestamp",
            "example": "2024-09-11T10:30:00.000Z"
          }
        }
      },
      "NotFoundResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "example": "NotFound"
          },
          "message": {
            "type": "string",
            "example": "No appointments found for the specified insured ID"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Access-Control-Allow-Origin": {
        "type": "string",
        "default": "*",
        "example": "https://developer.mozilla.org"
      },
      "Access-Control-Allow-Credentials": {
        "type": "boolean",
        "default": true
      },
      "insuredId": {
        "type": "string",
        "pattern": "^\\d{5}$",
        "example": "12345"
      }
    }
  },
  "info": {
    "title": "Medical Appointments API",
    "description": "Serverless API for managing medical appointments in Peru and Chile",
    "version": "1.0.0",
    "contact": {
      "name": "API Support",
      "email": "support@medical-appointments.com"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "paths": {
    "/appointments": {
      "post": {
        "summary": "Create a new medical appointment",
        "description": "Creates a new appointment for a patient in the specified country (PE or CL)",
        "operationId": "appointment",
        "parameters": [],
        "tags": [
          "appointments"
        ],
        "requestBody": {
          "description": "Appointment creation data",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAppointmentRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Appointment created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateAppointmentResponse"
                }
              }
            },
            "headers": {
              "Access-Control-Allow-Origin": {
                "description": "The Access-Control-Allow-Origin response header indicates whether the response can be shared with requesting code from the given [origin](https://developer.mozilla.org/en-US/docs/Glossary/Origin). - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Origin"
                }
              },
              "Access-Control-Allow-Credentials": {
                "description": "The Access-Control-Allow-Credentials response header tells browsers whether to expose the response to the frontend JavaScript code when the request's credentials mode ([Request.credentials](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials)) is include. - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Credentials"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {
              "Access-Control-Allow-Origin": {
                "description": "The Access-Control-Allow-Origin response header indicates whether the response can be shared with requesting code from the given [origin](https://developer.mozilla.org/en-US/docs/Glossary/Origin). - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Origin"
                }
              },
              "Access-Control-Allow-Credentials": {
                "description": "The Access-Control-Allow-Credentials response header tells browsers whether to expose the response to the frontend JavaScript code when the request's credentials mode ([Request.credentials](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials)) is include. - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Credentials"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {
              "Access-Control-Allow-Origin": {
                "description": "The Access-Control-Allow-Origin response header indicates whether the response can be shared with requesting code from the given [origin](https://developer.mozilla.org/en-US/docs/Glossary/Origin). - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Origin"
                }
              },
              "Access-Control-Allow-Credentials": {
                "description": "The Access-Control-Allow-Credentials response header tells browsers whether to expose the response to the frontend JavaScript code when the request's credentials mode ([Request.credentials](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials)) is include. - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Credentials"
                }
              }
            }
          }
        }
      }
    },
    "/appointments/{insuredId}": {
      "get": {
        "summary": "Get appointments for an insured person",
        "description": "Retrieves all appointments for a specific insured person",
        "operationId": "getAppointments",
        "parameters": [
          {
            "name": "insuredId",
            "in": "path",
            "description": "5-digit insured identification code",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/insuredId"
            }
          }
        ],
        "tags": [
          "appointments"
        ],
        "responses": {
          "200": {
            "description": "Appointments retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppointmentListResponse"
                }
              }
            },
            "headers": {
              "Access-Control-Allow-Origin": {
                "description": "The Access-Control-Allow-Origin response header indicates whether the response can be shared with requesting code from the given [origin](https://developer.mozilla.org/en-US/docs/Glossary/Origin). - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Origin"
                }
              },
              "Access-Control-Allow-Credentials": {
                "description": "The Access-Control-Allow-Credentials response header tells browsers whether to expose the response to the frontend JavaScript code when the request's credentials mode ([Request.credentials](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials)) is include. - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Credentials"
                }
              }
            }
          },
          "404": {
            "description": "No appointments found for the insured person",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NotFoundResponse"
                }
              }
            },
            "headers": {
              "Access-Control-Allow-Origin": {
                "description": "The Access-Control-Allow-Origin response header indicates whether the response can be shared with requesting code from the given [origin](https://developer.mozilla.org/en-US/docs/Glossary/Origin). - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Origin"
                }
              },
              "Access-Control-Allow-Credentials": {
                "description": "The Access-Control-Allow-Credentials response header tells browsers whether to expose the response to the frontend JavaScript code when the request's credentials mode ([Request.credentials](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials)) is include. - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Credentials"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            },
            "headers": {
              "Access-Control-Allow-Origin": {
                "description": "The Access-Control-Allow-Origin response header indicates whether the response can be shared with requesting code from the given [origin](https://developer.mozilla.org/en-US/docs/Glossary/Origin). - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Origin"
                }
              },
              "Access-Control-Allow-Credentials": {
                "description": "The Access-Control-Allow-Credentials response header tells browsers whether to expose the response to the frontend JavaScript code when the request's credentials mode ([Request.credentials](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials)) is include. - [MDN Link](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials)",
                "schema": {
                  "$ref": "#/components/schemas/Access-Control-Allow-Credentials"
                }
              }
            }
          }
        }
      }
    }
  },
  "servers": [
    {
      "url": "https://api.medical-appointments.com",
      "description": "Production server"
    },
    {
      "url": "https://dev-api.medical-appointments.com",
      "description": "Development server"
    }
  ],
  "tags": [
    {
      "name": "appointments",
      "description": "Medical appointment operations"
    }
  ]
}